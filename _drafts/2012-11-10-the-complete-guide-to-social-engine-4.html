---
layout: post
title: 'The Complete Guide to Social Engine 4 Module Development Part 4: Permissions
  and Privacy'
date: '2012-11-10T22:35:00.000-08:00'
author: Marco Enrico
tags:
- levels
- socialengine
- permissions
- authorization
- se4
modified_time: '2013-07-23T00:51:54.085-07:00'
blogger_id: tag:blogger.com,1999:blog-8533127149230967660.post-6646950605176579750
blogger_orig_url: http://social-engine-tutorials.blogspot.com/2012/11/the-complete-guide-to-social-engine-4.html
---

After a long haitus it's back. Next up: permissions and privacy<br /><br />The permissions/privacy mechanism of SE4 is provided by the core module Authorization. The stuff that makes it all go are two tables, <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">engine4_authorization_permissions</span> and <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">engine4_authorization_allow</span>. The permissions table has information on which/who can do so and so in a general context. The allow table has information on which&nbsp; can do so and so on a particular resource/SE4 item. The admin permission settings that you set on admin the admin page generally goes to the permissions table and the privacy settings that end users set on various items they create or own on the site goes to the allow table.<br /><br />Permissions are set typically when the module is installed. They are in the permissions section of <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">/application/modules/&lt;Modulename&gt;/settings/my.sql</span>. I wont be discussing how the whole mechanism works since it will take a whole other post. Lets tackle it with an example. On the Video_IndexController&nbsp; is this snippet:<br /><br /><script class="brush:php" type="syntaxhighlighter"><![CDATA[ if( !$this-&gt;_helper-&gt;requireAuth()-&gt;setAuthParams('video', null, 'view')-&gt;isValid()) return; ]]></script><br />This just checks if the current viewer (2nd parameter, <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">null</span> means the current viewer) can view (3rd parameter) videos (video items, 1st parameter). If not the request is forwarded to the "not permitted" page. Whether the <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">isValid</span> method returns a true or false is based on the content of the <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">engine4_authorization_permissions</span> table. You may refer the <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">my.sql</span> file of each module to see how it works.<br /><br />The defaults on<span style="font-family: &quot;Courier New&quot;,Courier,monospace;"> my.sql</span> are straight forward. Most of the time you can just copy/paste and search/replace the parameters for it to fit your needs. <br /><br />The permissions section of my.sql sets the default permissions. To enable a administrator to edit these settings. An admin page for it must be created. In the case of the video module this is handled by the level action of the <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">Video_AdminSettingsController</span>.<br /><br />Allows are set&nbsp; during item creation and can be changed when the item settings are edited. These are the "privacy settings" on the creation form. In the video module these are in the <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">Video_IndexController</span>, in createAction and marked "AUTH STUFF".<br /><br />Allows determines who can do something on an item. These must be set on the created item otherwise the only one who will be able to do something (view, edit, comment, share, delete, etc.) on the item will be the owner of the item or super admins.<br /><br />Much the same way as permissions. You may copy/paste and search/replace the "AUTH STUFF" snippets of most modules so you can use them on the modules you are creating.<br /><br />There is a quick shortcut that can be used when dealing privacy/allows. Let say for example in our Car module we want the car's privacy setting to be the same as the owner's privacy setting. The owner of cars are users. Users' privacy settings are under <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">members/settings/privacy</span>. For that to be the case. We can define the <span style="font-family: &quot;Courier New&quot;,Courier,monospace;">getAuthorizationItem</span> method in our car model. Like so:<br /><br /><script class="brush:php" type="syntaxhighlighter"><![CDATA[ public function getAuthorizationItem() {   return $this-&gt;getOwner(); } ]]></script><br />With this in place we can remove the privacy fields in our creation form. Authorization can be utilized to determine when/how and to whom menus and menu items are displayed. This is the subject of the <a href="{{ site.baseurl }}{% post_url 2012-11-18-the-complete-guide-to-social-engine-4_18 %}">next</a> part.